#:kivy 1.0
#:import FadeTransition kivy.uix.screenmanager.FadeTransition
ScreenManager:
    app: None
    id: screen_manager
    transition: FadeTransition()
    MainScreen:
        manager: screen_manager
        app: self.manager.app
    ProducerJoiningScreen:
        manager: screen_manager
        app: self.manager.app
        TextInput:
            id: servername
            size_hint: (.5, .15)
            text_size: root.width, None
            font_size: '35sp'
            multiline: False
            hint_text: 'MyServer'
            pos: (350, 400)
        TextInput:
            id: username
            size_hint: (.5, .15)
            text_size: root.width, None
            font_size: '35sp'
            multiline: False
            hint_text: 'SvenTheMonkeyDr520'
            pos: (350, 300)
        TextInput:
            id: password
            size_hint: (.5, .15)
            text_size: root.width, None
            font_size: '35sp'
            multiline: False
            password: True
            hint_text: '********'
            pos: (350, 200)
        ImageButton:
            id: joinsess
            source: '../img/right_arrow.png'
            halign: 'center'
            valign: 'middle'
            size_hint: (.35, .15)
            text_size: root.width, None
            font_size: '25sp'
            pos: (420, 50)
            on_release: self.parent.get_text(servername.text, username.text, password.text)
    ArtistJoiningScreen:
        manager: screen_manager
        app: self.manager.app
        TextInput:
            id: artconnection
            size_hint: (.8, .15)
            text_size: root.width, None
            font_size: '25sp'
            multiline: True
            hint_text: 'e.g. MTAwNDszYjIwODAyYzk1YmM0NjE3MTVlM2NmZ\nGQ4YzY2NGYyOzQ1LjE3LjE2MC43NA=='
            pos: (80, 320)
        ImageButton:
            id: artjoinsess
            text: 'Join Session'
            source: '../img/right_arrow.png'
            halign: 'center'
            valign: 'middle'
            size_hint: (.5, None)
            text_size: root.width, None
            font_size: '25sp'
            pos: (200, 100)
            on_release: self.parent.get_text(artconnection.text)
    SessionScreen:
        manager: screen_manager
        app: self.manager.app
        TextInput:
            id: chatText
            size_hint: (.50, .10)
            text_size: root.width, None
            font_size: '18sp'
            hint_text: 'Type to chat'
            multiline: False
            on_text_validate: self.parent.send_message(chatText.text)

            pos: (10, 300)
    SettingsScreen:
        manager: screen_manager
        app: self.manager.app
        TextInput:
            id: username_setting
            size_hint: (.5, .10)
            text_size: root.width, None
            font_size: '25sp'
            multiline: False
            hint_text: 'TRUE'
            pos: (170, 480)
            on_text_validate: self.parent.update_username(username_setting.text)
        TextInput:
            id: setting2
            size_hint: (.5, .10)
            text_size: root.width, None
            font_size: '25sp'
            multiline: False
            hint_text: 'YES'
            pos: (170, 415)
        TextInput:
            id: setting3
            size_hint: (.5, .10)
            text_size: root.width, None
            font_size: '25sp'
            multiline: False
            hint_text: 'ON'
            password: True
            pos: (170, 350)
    FileTransferScreen:
        app: self.manager.app
        manager: screen_manager

<MainScreen>:
    name: "main"
    Label:
        id: title
        text: 'High Quality Chat'
        text_size: root.width, None
        size: self.texture_size
        font_size: '70sp'
        pos: (135, 175)
        bold: True
        markup: True
    BoxLayout:
        pos: (350, 520)
        spacing: '50'
        ImageButton:
            source: '../img/settings.png'
            size_hint: .1, .1
            on_release: app.root.current = 'settings'
    BoxLayout:
        spacing: '5'
        padding: [150, 225, 150, 150]
        Button:
            id: producer
            text: "I'm a Producer"
            on_release: app.root.current = "producersessionjoining"
            size_hint: (.33, 1)
            font_size: '20sp'
        Button:
            id: artist
            text: "I'm an Artist"
            on_release: app.root.current = "artistsessionjoining"
            size_hint: (.33, 1)
            font_size: '20sp'
        Button:
            id: listener
            text: "I'm a Listener"
            on_release: app.root.current = "artistsessionjoining"
            size_hint: (.33, 1)
            font_size: '20sp'
<ProducerJoiningScreen>
    name: "producersessionjoining"
    Label:
        text: 'Server Address:'
        text_size: root.width, None
        size: self.texture_size
        font_size: '35sp'
        pos: (90, 150)
        bold: True
    Label:
        text: 'User Name:'
        text_size: root.width, None
        size: self.texture_size
        font_size: '35sp'
        pos: (153, 50)
        bold: True
    Label:
        text: 'Password:'
        text_size: root.width, None
        size: self.texture_size
        font_size: '35sp'
        pos: (170, -50)
        bold: True
<ArtistJoiningScreen>
    name: "artistsessionjoining"
    Label:
        text: 'Connection String:'
        text_size: root.width, None
        size: self.texture_size
        font_size: '35sp'
        pos: (40, 150)
        bold: True
<SessionScreen>:
    name: "session"
    ActionBar:
        ActionView:
            ActionPrevious:
                title: 'HQC: Session Name'
                with_previous: False
                app_icon: '../img/orion_just_stars.png'
            ActionOverflow:
            ActionImageButton:
                id: mute_button
                source: root.muted_mic_image
                group: 'volume'
                on_press: root.toggle_mute()

            ActionButton:
                background_normal: 'atlas://data/images/defaulttheme/audio-volume-high'
            ActionGroup:
                ActionImageButton:
                    source: '../img/sign_out_option.png'
                    text: 'Leave Session'
                    on_release: app.root.current = "main"
    ProgressBar:
        id: progress_bar
        size_hint: (0.6, 0.25)
        pos: (0, 5)
        value: 0
        max: 30
    ImageButton:
        id: record_button
        source: '../img/record_red.png'
        font_size: '25sp'
        size_hint: (.25, .25)
        pos: (100, 100)
        on_press: root.record_button()
    ImageButton:
        id: pause_button
        source: '../img/pause_black.png'
        size_hint: (.17, .17)
        pos: (280, 120)
        on_release: self.parent.get_text(chatText.text)

    TabbedPanel:
        size_hint: (.4, .9)
        pos_hint: {'center_x': .8, 'center_y': .55}
        do_default_tab: False
        TabbedPanelItem:
            tab_width: 300
            text: 'Select Clips'
            ScrollView:
                size_hint: (None, None)
                size: (310, 460)
                pos_hint: {'center_x': .5, 'center_y': .5}
                do_scroll_x: False
                GridLayout:
                    id: audioSidebar
                    cols: 3
                    padding: 10
                    spacing: 5
                    size_hint: (None, None)
                    width: 310
        TabbedPanelItem:
            text: 'Edit Tools'
            tab_width: 400
            GridLayout:
                cols: 1
                Button:
                    id: menuCrop
                    text: 'Crop Out'
                    font_size: '18sp'
                Button:
                    id: menuSave
                    text: 'Save'
                    font_size: '18sp'
                Button:
                    id: undo
                    text: 'Undo'
                    font_size: '18sp'
                Button:
                    id: redo
                    text: 'Redo'
                    font_size: '18sp'
    BoxLayout:
        ScrollView:
            size_hint: (None, None)
            size: (400, 200)
            pos_hint: {'center_x':.3, 'center_y':.78}
            scroll_y: 0
            Label:
                text: root.chat_messages
                markup: True
                text_size: self.width, None
                size_hint_y: None
                height: self.texture_size[1]
                halign: 'left'
                valign: 'top'
<SettingsScreen>
    name: "settings"
    ImageButton:
        id: main_menu
        source: '../img/left_arrow.png'
        text: 'Main Menu'
        halign: 'center'
        valign: 'middle'
        size_hint: (.20, .10)
        text_size: root.width, None
        font_size: '25sp'
        pos: (670, 520)
        on_release: app.root.current = 'main'
    Label:
        text: 'Username'
        text_size: root.width, None
        size: self.texture_size
        font_size: '25sp'
        pos: (30, 215)
        bold: True
    Label:
        text: 'Microphone'
        text_size: root.width, None
        size: self.texture_size
        font_size: '25sp'
        pos: (20, 150)
        bold: True
    Label:
        text: 'Speakers'
        text_size: root.width, None
        size: self.texture_size
        font_size: '25sp'
        pos: (30, 85)
        bold: True
    Button:
        id: save_settings
        text: 'Save Settings'
        halign: 'center'
        valign: 'middle'
        size_hint: (.25, .10)
        text_size: root.width, None
        font_size: '25sp'
        pos: (300, 50)
        on_release: app.root.current = 'main'
<FileTransferScreen>
    name: "filetransfer"
    BoxLayout:
        id: filelayout
        orientation: 'vertical'
        padding: [0, 0, 0, 150]
    Button:
        id: leave_file
        text: 'Return to Main Menu'
        halign: 'center'
        valign: 'middle'
        size_hint: (.4, .10)
        text_size: root.width, None
        font_size: '25sp'
        pos: (250, 50)
        on_release: app.root.current = 'main'
